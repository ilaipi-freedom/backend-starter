{"version":3,"sources":["sourceMap"],"names":["__decorate","_0x26a540","_0x4dfdd0","_0x1d9d60","_0x219482","_0x486247","arguments","_0x5edce1","Object","_0x38967e","Reflect","_0x36b689","__metadata","_0x11a136","_0x3166e8","exports","common_1","require","core_1","passport_1","public_1","JwtAuthGuard","constructor","_0x237473","_0x3fb7a2","_0x40b1eb","_0x1e3b3b","_0x59ad98","_0x9e4c72","_0x3ccc50","_0x3bf884"],"mappings":"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","sourcesContent":["\"use strict\";\nvar __decorate = (this && this.__decorate) || function (decorators, target, key, desc) {\n    var c = arguments.length, r = c < 3 ? target : desc === null ? desc = Object.getOwnPropertyDescriptor(target, key) : desc, d;\n    if (typeof Reflect === \"object\" && typeof Reflect.decorate === \"function\") r = Reflect.decorate(decorators, target, key, desc);\n    else for (var i = decorators.length - 1; i >= 0; i--) if (d = decorators[i]) r = (c < 3 ? d(r) : c > 3 ? d(target, key, r) : d(target, key)) || r;\n    return c > 3 && r && Object.defineProperty(target, key, r), r;\n};\nvar __metadata = (this && this.__metadata) || function (k, v) {\n    if (typeof Reflect === \"object\" && typeof Reflect.metadata === \"function\") return Reflect.metadata(k, v);\n};\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.JwtAuthGuard = void 0;\nconst common_1 = require(\"@nestjs/common\");\nconst core_1 = require(\"@nestjs/core\");\nconst passport_1 = require(\"@nestjs/passport\");\nconst public_1 = require(\"../helpers/public\");\nlet JwtAuthGuard = class JwtAuthGuard extends (0, passport_1.AuthGuard)('jwt') {\n    constructor(reflector) {\n        super();\n        this.reflector = reflector;\n    }\n    async canActivate(context) {\n        const isPublic = this.reflector.getAllAndOverride(public_1.IS_PUBLIC_KEY, [\n            context.getHandler(),\n            context.getClass(),\n        ]);\n        if (isPublic) {\n            return true;\n        }\n        try {\n            const canActivate = (await super.canActivate(context));\n            return canActivate;\n        }\n        catch (err) {\n            if (err.name === 'TokenExpiredError') {\n                throw new common_1.UnauthorizedException('Token has expired');\n            }\n            if (err.name === 'JsonWebTokenError') {\n                throw new common_1.UnauthorizedException('Invalid token');\n            }\n            if (err.message === 'No auth token') {\n                throw new common_1.UnauthorizedException('No token provided');\n            }\n            throw err;\n        }\n    }\n    handleRequest(err, user, info) {\n        if (err || !user) {\n            if (info && info.name === 'TokenExpiredError') {\n                throw new common_1.UnauthorizedException('Token has expired');\n            }\n            else if (info && info.name === 'JsonWebTokenError') {\n                throw new common_1.UnauthorizedException('Invalid token');\n            }\n            throw err || new common_1.UnauthorizedException();\n        }\n        return user;\n    }\n};\nexports.JwtAuthGuard = JwtAuthGuard;\nexports.JwtAuthGuard = JwtAuthGuard = __decorate([\n    (0, common_1.Injectable)(),\n    __metadata(\"design:paramtypes\", [core_1.Reflector])\n], JwtAuthGuard);\n//# sourceMappingURL=auth.guard.js.map"]}